# =====================================
# Security Headers
# =====================================

add_header X-Frame-Options "SAMEORIGIN" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-XSS-Protection "1; mode=block" always;
add_header Referrer-Policy "same-origin" always;

# =====================================
# Block sensitive files 
# =====================================

# Block common exploit attempts
location ~ /\. {
    deny all;
    access_log off;
    log_not_found off;
}

# Block access to sensitive files
location ~ /(?:composer|package|yarn)(?:\.json|\.lock)$ {
    deny all;
}

location ~ /(?:\.git|node_modules|vendor)/ {
    deny all;
}

# Block PHP execution in upload directories (if applicable)
location ~ /(?:uploads|files|wp-content|wp-includes)/.*\.php$ {
    deny all;
}
