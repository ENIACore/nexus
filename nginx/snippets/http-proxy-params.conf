# =====================================
# Common HTTP Proxy Parameters
# =====================================

proxy_http_version 1.1;  # Use HTTP/1.1 for better performance

# Standard proxy headers for Nextcloud
proxy_set_header Host $host;                      # So Nextcloud knows the domain
proxy_set_header X-Real-IP $remote_addr;          # Client IP for logs/security
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; # Full proxy chain
proxy_set_header X-Forwarded-Proto $scheme;       # So Nextcloud knows HTTPS was used
proxy_set_header X-Forwarded-Port $server_port;   # Original port for URL generation
proxy_set_header X-Forwarded-Scheme $scheme;      # Protocol scheme
proxy_set_header Early-Data $ssl_early_data;      # TLS 1.3 early data indicator

# HTTP-optimized timeouts (shorter than WebSocket)
proxy_connect_timeout 10s;      # Quick connection expected
proxy_send_timeout 300s;        # 5 minutes for large uploads
proxy_read_timeout 300s;        # 5 minutes for slow responses

# Buffering settings optimized for HTTP traffic
proxy_buffering off;            # Disabled for real-time upload progress
proxy_request_buffering off;    # Allows streaming uploads without temp files

